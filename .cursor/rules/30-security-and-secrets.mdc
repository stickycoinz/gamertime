---
title: Security & Secrets
type: always
---

# Security Rules

## Secrets Management
- Never commit secrets; read from env. Provide `.env.example`.
- Use python-dotenv for local development
- Validate required environment variables on startup

## Logging & Privacy
- Do not log PII, access tokens, or IP + room together.
- Sanitize logs; don't log room codes together with IPs.
- Use structured logging with appropriate log levels

## Input Validation
- Validate all inputs with Pydantic; reject oversize payloads.
- Implement rate limiting on sensitive endpoints
- Sanitize user-generated content (chat, names)

## Authentication & Authorization
- Validate room codes and player permissions
- Implement proper session management
- Use secure WebSocket connections in production

## Data Protection
- Don't store unnecessary personal data
- Implement proper cleanup of expired sessions
- Use HTTPS/WSS in production environments